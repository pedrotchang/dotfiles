# ~~~~~~~~~~~~~~~ General ~~~~~~~~~~~~~~~~~~~~~~~~

alias c="clear"
alias ..="cd .."

# ~~~~~~~~~~~~~~~ Editor ~~~~~~~~~~~~~~~~~~~~~~~~

alias v="nvim"

# ~~~~~~~~~~~~~~~ File Listing ~~~~~~~~~~~~~~~~~~~~~~~~

if command -v lsd &>/dev/null; then
  alias ls="lsd"
  alias ll="ls -lgh"
  alias la="ls -a"
  alias lla="ls -lgha"
  alias lt="ls --tree"
else
  alias ls="ls --color=auto"
  alias ll="ls -la"
  alias la="ls -A"
  alias lla="ll -A"
fi

alias cat="bat"

# ~~~~~~~~~~~~~~~ Git ~~~~~~~~~~~~~~~~~~~~~~~~

alias g="git"
alias gp="git pull"
alias gps="git push"
alias gpall='git remote | xargs -I {} git push {}'  # Push to all remotes (GitHub + Forgejo)
alias gs="git status"
alias lg="lazygit"

# ~~~~~~~~~~~~~~~ Tmux ~~~~~~~~~~~~~~~~~~~~~~~~

alias t="tmux"
alias tms="$GHREPOS/local-scripts/tmux-layout.sh"
alias tmd="$GHREPOS/local-scripts/kubie-tmux.sh"

# ~~~~~~~~~~~~~~~ Kubernetes ~~~~~~~~~~~~~~~~~~~~~~~~

alias k="kubectl"
alias kgp="kubectl get pods"
alias kc="kubectx"
alias kn="kubens"

# Minikube
alias mk="minikube kubectl --"
alias mkd="minikube dashboard"

# Omnictl
alias omniauth='omnictl kubeconfig --service-account -c $CLUSTER_NAME --user pedrotychang /homelab/$CLUSTER_NAME-kubeconfig.yaml'

# ~~~~~~~~~~~~~~~ Directories ~~~~~~~~~~~~~~~~~~~~~~~~

alias scripts="cd $SCRIPTS"
alias lab="cd $LAB"
alias dot="cd $GHREPOS/dotfiles/"
alias home="cd $GHREPOS/homelab/"
alias gr="cd $GHREPOS"
alias tach="cd $GHREPOS/homelab/clusters/tachtit/"
alias data="cd $GHREPOS/homelab/clusters/data/"
alias blog="cd $GHREPOS/blog/"
alias in="cd $HOME/secondbrain/0-inbox/"
alias cdsb="cd $HOME/secondbrain/"

# Mischa's repos
alias mvhome="cd $REPOS/github.com/mischavandenburg/homelab"
alias mvdot="cd $REPOS/github.com/mischavandenburg/dotfiles"

# ~~~~~~~~~~~~~~~ DevPod ~~~~~~~~~~~~~~~~~~~~~~~~

if [[ "$(uname)" == "Darwin" ]] || grep -q 'ID=arch' /etc/os-release 2>/dev/null; then
  alias devdata='devpod up . --devcontainer-path .devcontainer/data/devcontainer.json --id data --workspace-env GITHUB_TOKEN=$(pass github/mise-token)'
  alias devtach='devpod up . --devcontainer-path .devcontainer/tachtit/devcontainer.json --id tachtit --workspace-env GITHUB_TOKEN=$(pass github/mise-token)'
fi

# ~~~~~~~~~~~~~~~ AWS ~~~~~~~~~~~~~~~~~~~~~~~~

alias awsq="aws ec2 describe-instances --query 'Reservations[*].Instances[*].[InstanceId,PublicIpAddress,State.Name,KeyName]' --output table"

# ~~~~~~~~~~~~~~~ Arch Linux ~~~~~~~~~~~~~~~~~~~~~~~~

if [[ -f /etc/arch-release ]]; then
  alias up-pacl='pacman -Qqen > ~/.local/share/chezmoi/dot_config/pacman/pkglist.txt'
  alias up-pacy='pacman -Qqem > ~/.local/share/chezmoi/dot_config/pacman/aurlist.txt'
  alias up-pac='up-pacl && up-pacy && echo "Package lists updated"'
fi

# ~~~~~~~~~~~~~~~ macOS ~~~~~~~~~~~~~~~~~~~~~~~~

{{- if eq .chezmoi.os "darwin" }}
alias mvcv="cp $GHREPOS/maincv/rendercv_output/pedro_tae_young_chang_cv.pdf $GHREPOS/blog/static"
{{- end }}

# ~~~~~~~~~~~~~~~ FZF ~~~~~~~~~~~~~~~~~~~~~~~~

alias hb="history | fzf"

# ~~~~~~~~~~~~~~~ Pass OTP ~~~~~~~~~~~~~~~~~~~~~~~~

otp-add() {
  read -rp "QR image path: " img
  [[ ! -f "$img" ]] && echo "File not found: $img" && return 1
  read -rp "Account name: " account
  [[ -z "$account" ]] && echo "Account name required" && return 1
  zbarimg -q --raw "$img" | pass otp append "$account" && rm -v "$img"
}
