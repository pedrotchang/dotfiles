{{- $remote := or (env "CODESPACES" | not | not) (env "SSH_CONNECTION" | not | not) (env "KUBERNETES_SERVICE_HOST" | not | not) (env "container" | not | not) (env "REMOTE_CONTAINERS" | not | not) (stat "/.dockerenv" | not | not) -}}

# ~~~~~~~~~~~~~~~ Environment Variables ~~~~~~~~~~~~~~~~~~~~~~~~
export PATH="$HOME/.npm-global/bin:$PATH"

# Repos
export REPOS="$HOME/Repos"
export GITUSER="pedrotchang"
export GHREPOS="$REPOS/github.com/$GITUSER"
export DOTFILES="$GHREPOS/dotfiles"
export LAB="$GHREPOS/lab"
export SECONDBRAIN="$HOME/secondbrain"

# Go
export GOPATH="$HOME/go"
export GOBIN="$HOME/.local/bin"

# Ruby (user-installed gems)
export GEM_HOME="$HOME/.local/share/gem"
export GEM_BIN="$GEM_HOME/ruby/3.4.0/bin"

export PATH="$HOME/.claude/cli-tools:$GOBIN:$GEM_BIN:$PATH"

# ~~~~~~~~~~~~~~~ History ~~~~~~~~~~~~~~~~~~~~~~~~

HISTFILE="$HOME/.bash_history"
HISTSIZE=80000
HISTFILESIZE=50000

# ~~~~~~~~~~~~~~~ Shell Options ~~~~~~~~~~~~~~~~~~~~~~~~

set -o vi
shopt -s extglob nullglob

# ~~~~~~~~~~~~~~~ Completions ~~~~~~~~~~~~~~~~~~~~~~~~

[[ -r /usr/share/bash-completion/bash_completion ]] && source /usr/share/bash-completion/bash_completion

command -v kubectl &>/dev/null && source <(kubectl completion bash)
command -v flux &>/dev/null && source <(flux completion bash)

# ~~~~~~~~~~~~~~~ Tool Initialization ~~~~~~~~~~~~~~~~~~~~~~~~

command -v mise &>/dev/null && eval "$(mise activate bash)"
command -v starship &>/dev/null && eval "$(starship init bash)"
command -v fzf &>/dev/null && eval "$(fzf --bash)"

# ~~~~~~~~~~~~~~~ Editor ~~~~~~~~~~~~~~~~~~~~~~~~

if command -v nvim &>/dev/null; then
  export EDITOR="nvim"
  export VISUAL="nvim"
fi

# ~~~~~~~~~~~~~~~ Aliases ~~~~~~~~~~~~~~~~~~~~~~~~

[[ -f ~/.config/terminal/aliases ]] && source ~/.config/terminal/aliases

# ~~~~~~~~~~~~~~~ Platform Specific ~~~~~~~~~~~~~~~~~~~~~~~~

{{- if eq .chezmoi.os "darwin" }}
[[ -d /homelab ]] && cd /homelab
export PATH="$HOME/.rd/bin:$PATH"
{{- end }}
